syntax = "proto3";

option go_package = "pmtstm.v1;pmtstmv1";

package sso;

import "sso/shared.proto";

service PermissionService {
  rpc CreatePermission (CreatePermissionRequest) returns (CreatePermissionResponse);
  rpc DeletePermission (DeletePermissionRequest) returns (DeletePermissionResponse);
  rpc GetPermissionByID (GetPermissionByIDRequest) returns (GetPermissionByIDResponse);
  rpc GetPermissionByCode (GetPermissionByCodeRequest) returns (GetPermissionByCodeResponse);
  rpc ListPermissions (ListPermissionsRequest) returns (ListPermissionsResponse);
  rpc UpdatePermission (UpdatePermissionRequest) returns (UpdatePermissionResponse);
  rpc AddPermissionToRole (AddPermissionToRoleRequest) returns (AddPermissionToRoleResponse);
  rpc RevokePermissionFromRole (RevokePermissionFromRoleRequest) returns (RevokePermissionFromRoleResponse);
  rpc GetRolePermissions (GetRolePermissionsRequest) returns (GetRolePermissionsResponse);
  rpc HasRolePermission (HasRolePermissionRequest) returns (HasRolePermissionResponse);
  rpc GetUserPermissions (GetUserPermissionsRequest) returns (GetUserPermissionsResponse);
  rpc HasUserPermission (HasUserPermissionRequest) returns (HasUserPermissionResponse);
}

message CreatePermissionRequest {
  string code = 1;
  string description = 2;
}

message CreatePermissionResponse {
  string perm_id = 1;
}

message DeletePermissionRequest {
  string perm_id = 1;
}

message DeletePermissionResponse {}

message GetPermissionByIDRequest {
  string perm_id = 1;
}

message GetPermissionByIDResponse {
  Permission permission = 1;
}

message GetPermissionByCodeRequest {
  string code = 1;
}

message GetPermissionByCodeResponse {
  Permission permission = 1;
}

message ListPermissionsRequest {
  int32 limit = 1;
  int32 offset = 2;
}

message ListPermissionsResponse {
  repeated Permission permission = 1;
}

message UpdatePermissionRequest {
  string perm_id = 1;
  string description = 2;
}

message UpdatePermissionResponse {}

message AddPermissionToRoleRequest {
  string role_id = 1;
  string perm_id = 2;
}

message AddPermissionToRoleResponse {}

message RevokePermissionFromRoleRequest {
  string role_id = 1;
  string perm_id = 2;
}

message RevokePermissionFromRoleResponse {}

message GetRolePermissionsRequest {
  string role_id = 1;
}

message GetRolePermissionsResponse {
  repeated Permission permission = 1;
}

message HasRolePermissionRequest {
  string role_id = 1;
  string code = 2;
}

message HasRolePermissionResponse {
  bool allowed = 1;
}

message GetUserPermissionsRequest {
  string user_id = 1;
}

message GetUserPermissionsResponse {
  repeated Permission permission = 1;
}

message HasUserPermissionRequest {
  string user_id = 1;
  string code = 2;
}

message HasUserPermissionResponse {
  bool allowed = 1;
}
